<?php
session_start();
include_once 'dbconnect.php';

if(!isset($_SESSION['user']))
{
    header("Location: login.php");
}
$res=mysql_query("SELECT * FROM admins WHERE user_id=".$_SESSION['user']);
$userRow=mysql_fetch_array($res);
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <meta name="author" content="ESCOM - IPN">
    <link rel="apple-touch-icon" sizes="57x57" href="../assets/ico/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="../assets/ico/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="../assets/ico/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="../assets/ico/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="../assets/ico/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="../assets/ico/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="../assets/ico/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="../assets/ico/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../assets/ico/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="assets/ico/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../assets/ico/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="../assets/ico/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../assets/ico/favicon-16x16.png">
    <link rel="manifest" href="../assets/ico/manifest.json">
    <meta name="msapplication-TileColor" content="#607d8b">
    <meta name="msapplication-TileImage" content="assets/ico/ms-icon-144x144.png">
    <meta name="theme-color" content="#607d8b">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <!-- Titulo -->
    <title>Welcome - <?php echo $userRow['username']; ?></title>

    <!-- CSS  -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
    <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
    <link href="css/polyglot-language-switcher.css" type="text/css" rel="stylesheet" />

    <!--Scripts-->
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

    <!-- Libreria Materialize -->
    <script type="text/javascript" src="../js/materialize.min.js"></script>
    <script type="text/javascript" src="../js/init.js"></script>
    <!-- Polyglot -->
    <script src="../js/jquery.polyglot.language.switcher.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            $('#polyglotLanguageSwitcher').polyglotLanguageSwitcher({
                effect: 'fade',
                testMode: false,
                onChange: function(evt) {
                    Cookies.set('langCookie', evt.selectedItem);
                    window.lang.change(evt.selectedItem);
                }
            });

        });
    </script>

    <script>
    function getQueryVariable(variable) {
       var query = window.location.search.substring(1);
       var vars = query.split("&");
       for (var i=0;i<vars.length;i++) {
               var pair = vars[i].split("=");
               if(pair[0] == variable){return pair[1];}
       }
       return(false);
    }
    </script>

    <!-- Cookies, Y Lang Para Idioma -->
    <script src="../js/js.cookie.js" charset="utf-8" type="text/javascript"></script>
    <script src="../js/jquery-lang.js" charset="utf-8" type="text/javascript"></script>
    <script>
        var lang = new Lang();
        lang.dynamic('en', '../js/langpack/en.json');
        lang.dynamic('it', '../js/langpack/it.json');
        lang.dynamic('fr', '../js/langpack/fr.json');
        lang.dynamic('jp', '../js/langpack/jp.json');
        var langus = getQueryVariable("lang");
        if(langus!=false){
            Cookies.set('langCookie', langus);
            lang.init({
                defaultLang: 'es',
                currentLang: langus
            });
        }else{
            lang.init({
                defaultLang: 'es'
            });
        }        
    </script>
</head>
<body>
<main>
    <nav class="grey darken-3" id="header">
        <div class="nav-wrapper container">
          <label>Panel de Control</label>
          <ul id="nav" class="right">
            <li><a href="javascript:logout();">Salir</a></li>
          </ul>
          <span class="right" style="margin-right:50px;">Bienvenido <?php echo $userRow['username']; ?>!</span>
        </div>
    </nav>
    <div id="body" class="container">
        <div class="section">
            <!--   Icon Section   -->
            <div class="row">
                <div class="col s12 m4 card">
                    <div class="icon-block">
                        <h2 class="center light-blue-text"><i class="material-icons">flash_on</i></h2>
                        <h5 class="center">Speeds up development</h5>
                        <p class="light">
                            We did most of the heavy lifting for you to provide a default stylings that incorporate our custom components. Additionally, we refined animations and transitions to provide a smoother experience for developers.
                        </p>
                    </div>
                </div>
                <div class="col s12 m4 card">
                    <div class="icon-block">
                        <h2 class="center light-blue-text"><i class="material-icons">group</i></h2>
                        <h5 class="center">User Experience Focused</h5>
                        <p class="light">
                            By utilizing elements and principles of Material Design, we were able to create a framework that incorporates components and animations that provide more feedback to users. Additionally, a single underlying responsive system across all platforms allow for a more unified user experience.
                        </p>
                    </div>
                </div>
                <div class="col s12 m4 card">
                    <div class="icon-block">
                        <h2 class="center light-blue-text"><i class="material-icons">settings</i></h2>
                        <h5 class="center">Easy to work with</h5>
                        <p class="light">
                            We have provided detailed documentation as well as specific code examples to help new users get started. We are also always open to feedback and can answer any questions a user may have about Materialize.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <br><br>
        <div class="section">
            <!--   Icon Section   -->
            <div class="row">
                <div class="col s12 card">
                <?php
                $res=mysql_query("SELECT * FROM horario");
                $horario=mysql_fetch_array($res);
                ?>
                    <table class="demo">
                        <caption>Horarios Registrados</caption>
                        <thead>
                        <tr>
                            <th>Grupo</th>
                            <th>Materia</th>
                            <th>Profesor</th>
                            <th>Salon</th>
                            <th>Lunes</th>
                            <th>Martes</th>
                            <th>Miercoles</th>
                            <th>Jueves</th>
                            <th>Viernes</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>&nbsp;1CM1</td>
                            <td>Algoritmia&nbsp;</td>
                            <td>Juan Vicente&nbsp;</td>
                            <td>1058&nbsp;</td>
                            <td>10:30&nbsp;</td>
                            <td>8:30&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>10:30&nbsp;</td>
                            <td>&nbsp;</td>
                        </tr>
                        <tr>
                            <td>&nbsp;1CM1</td>
                            <td>Analisis&nbsp;</td>
                            <td>Florencio&nbsp;</td>
                            <td>1074&nbsp;</td>
                            <td>07:00&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>7:00&nbsp;</td>
                            <td>8:30&nbsp;</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</main>
<footer class="page-footer blue-grey darken-2 z-depth-3">
    <div class="footer-copyright center">
        <p class="hide-on-small-only"><span lang="es">Hecho por </span>Rolando Romero, Miguel Sanchez, Ricardo Lara y Omar Zu&ntilde;iga.</p>
        <p>IPN - ESCOM &copy; 2016</p>
    </div>
</footer>
    <!--  Scripts-->
    <script src="js/materialize.js"></script>
    <script src="js/init.js"></script>
    <script>
    $( document ).ready(function() {
        $("#header").slideDown(500);
        $("#body").delay(650).fadeIn("slow");
    });

    </script>

    <script>
    function logout(){
        var newUrl = location.href.match( /^(http.+\/)[^\/]+$/ )[1];
        newUrl += "logout.php?logout";
        console.log(newUrl);
        $("#body").fadeOut("slow");
        $("#header").delay(650).slideUp(500).delay(500);
    setTimeout(  function()   { window.location = newUrl; }, 1000);
        
    }
    </script>
</body>
</html>